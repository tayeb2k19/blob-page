<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>فتح صفحة blob</title>
<style>
  body{font-family:system-ui,Segoe UI,Arial;display:grid;place-items:center;min-height:100vh;background:#0f172a;color:#e2e8f0;margin:0}
  .card{background:#111827;border:1px solid #1f2937;border-radius:12px;padding:24px;max-width:520px;box-shadow:0 10px 30px rgba(0,0,0,.25);text-align:center}
  button{cursor:pointer;background:#22c55e;border:none;color:#0b1220;font-weight:700;padding:12px 16px;border-radius:10px}
  button:hover{background:#16a34a}
  small{display:block;opacity:.8;margin-top:8px}
</style>
</head>
<body>
  <div class="card">
    <h1>فتح صفحة عبر رابط blob</h1>
    <p>اضغط “Go” لإنشاء صفحة ديناميكيًا وفتحها في تبويب جديد.</p>
    <button id="goBtn" type="button">Go</button>
    <small>قد تحتاج للسماح بالنوافذ المنبثقة في المتصفح.</small>
  </div>

<script>
(function(){
  function openBlobPage(){
    const pageHtml = `
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>صفحة من Blob</title>
  <style>
    body{font-family:system-ui,Segoe UI,Arial;display:grid;place-items:center;min-height:100vh;background:#111827;color:#e2e8f0;margin:0}
    .wrap{max-width:680px;padding:24px;text-align:center}
    h2{margin:0 0 8px;color:#38bdf8}
    p{line-height:1.7;color:#cbd5e1}
    code{background:#0b1220;color:#93c5fd;padding:.2em .4em;border-radius:6px}
  </style>
</head>
<body>
  <div class="wrap">
    <h2>تم فتح هذه الصفحة عبر <code>blob:</code></h2>
    <p>هذا المحتوى تم توليده لحظيًا داخل متصفحك.</p>
    <p>الوقت الآن: <span id="now"></span></p>
    <script>
      document.getElementById('now').textContent = new Date().toLocaleString();
    <\/script>
  </div>
</body>
</html>
    `.trim();

    const blob = new Blob([pageHtml], { type: 'text/html' });
    const url = URL.createObjectURL(blob);

    const win = window.open(url, '_blank', 'noopener,noreferrer');

    setTimeout(() => URL.revokeObjectURL(url), 15000);

    if(!win){
      alert('يبدو أن مانع النوافذ منع الفتح. اسمح بالنوافذ المنبثقة ثم أعد المحاولة.');
    }
  }

  document.getElementById('goBtn').addEventListener('click', openBlobPage);
})();
</script>
</body>
</html>
